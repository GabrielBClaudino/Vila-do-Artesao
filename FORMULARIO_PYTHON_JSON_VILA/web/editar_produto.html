<!doctype html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Editar Produto - Vila do Artesão</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script type="text/javascript" src="/eel.js"></script>
    <style>
        body {
            background-image: linear-gradient(to top, rgb(255, 255, 255),rgba(243, 114, 63, 0.514) );
            background-size: cover;
            background-position: center;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .container {
            background-color: white;
            border: 10px solid white;
            border-radius: 15px;
        }
        .botao {
            background: linear-gradient(to top, rgb(255, 125, 73), rgba(255, 255, 255, 0.993)) !important;
            border: 0px solid white !important;
            color: black;
        }
    </style>
</head>
<body>
    <main class="container">
        <a href="/deletar.html"><button type="button" class="botao btn btn-info">Voltar</button></a>
        <h1>Editar Produto</h1>
        <div id="editProdutoForm">
            <div class="mb-3">
                <label for="nome" class="form-label">Nome *</label>
                <input type="text" class="form-control" id="nome">
                <button onclick="editarNome();" class="botao btn btn-primary" id="adicionar">Confirmar</button>
            </div>
            <div class="mb-3">
                <label for="descricao" class="form-label">Descrição *</label>
                <textarea class="form-control" id="descricao" rows="3"></textarea>
                <button onclick="editarDescricao();" class="botao btn btn-primary" id="adicionar">Confirmar</button>
            </div>
            <div class="mb-3">
                <label for="preco" class="form-label">Preço *</label>
                <input type="number" class="form-control" id="preco">
                <button onclick="editarPreco();" class="botao btn btn-primary" id="adicionar">Confirmar</button>
            </div>
            <div class="mb-3">
                <label for="imagem" class="form-label">Imagem</label>
                <input type="text" class="form-control" id="imagem" placeholder="URL da imagem">
                <button onclick="editarImagem();" class="botao btn btn-primary" id="adicionar">Confirmar</button>
            </div>
            <div class="mb-3">
                <label for="idArtesao" class="form-label">ID do Artesão *</label>
                <input type="number" class="form-control" id="idArtesao">
                <button onclick="editarIdArtesao();" class="botao btn btn-primary" id="adicionar">Confirmar</button>
            </div>
        </div>
        <div id="mensagemSucesso" class="alert alert-success mt-3" style="display: none;">
            Informação Alterada!
        </div>
        <script type="text/javascript">

            // Função para extrair o ID do produto da URL
            function getProdutoIdFromUrl() {
                const urlParams = window.location.hash.replace("#","");
                return urlParams;
            }

            // Função para editar o nome do produto
            async function editarNome() {
                const id = getProdutoIdFromUrl();
                const novoNome = document.getElementById('nome').value;

                if (!novoNome) {
                    alert("O campo de nome não pode estar vazio");
                    return;
                }

                const response = await eel.editar_nome_produto_expose(parseInt(id), novoNome)();
                if (response === "Nome do produto atualizado com sucesso!") {
                    document.getElementById('mensagemSucesso').style.display = 'block';
                    alert(response);
                } else {
                    alert(response);
                }
            }


            // Função para editar a descrição do produto
            async function editarDescricao() {
                const id = getProdutoIdFromUrl();
                const novaDescricao = document.getElementById('descricao').value;

                if (!novaDescricao) {
                    alert("O campo de descrição não pode estar vazio");
                    return;
                }

                const response = await eel.editar_descricao_produto_expose(parseInt(id), novaDescricao)();
                if (response === "Descrição do produto atualizada com sucesso!") {
                    document.getElementById('mensagemSucesso').style.display = 'block';
                    alert(response);
                } else {
                    alert(response);
                }
            }

            // Função para editar o preço do produto
            async function editarPreco() {
                const id = getProdutoIdFromUrl();
                const novoPreco = document.getElementById('preco').value;

                if (!novoPreco) {
                    alert("O campo de preço não pode estar vazio");
                    return;
                }

                const response = await eel.editar_preco_produto_expose(parseInt(id), parseFloat(novoPreco))();
                if (response === "Preço do produto atualizado com sucesso!") {
                    document.getElementById('mensagemSucesso').style.display = 'block';
                    alert(response);
                } else {
                    alert(response);
                }
            }

            // Função para editar a imagem do produto
            async function editarImagem() {
                const id = getProdutoIdFromUrl();
                const novaImagem = document.getElementById('imagem').value;

                const response = await eel.editar_imagem_produto_expose(parseInt(id), novaImagem)();
                if (response === "Imagem do produto atualizada com sucesso!") {
                    document.getElementById('mensagemSucesso').style.display = 'block';
                    alert(response);
                } else {
                    alert(response);
                }
            }

            // Função para editar o ID do artesão do produto
            async function editarIdArtesao() {
                const id = getProdutoIdFromUrl();
                const novoIdArtesao = document.getElementById('id')
                if (!novoIdArtesao) {
                alert("O campo de ID do artesão não pode estar vazio");
                return;
            }

            const response = await eel.editar_id_artesao_produto_expose(parseInt(id), parseInt(novoIdArtesao))();
            if (response === "ID do artesão do produto atualizado com sucesso!") {
                document.getElementById('mensagemSucesso').style.display = 'block';
                alert(response);
            } else {
                alert(response);
            }
        }
    </script>
</main>
</body>
</html>